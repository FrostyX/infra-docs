Contact Information

   Owner: Fedora Infrastructure Team

   Contact: #fedora-admin, sysadmin-main, sysadmin-releng

   Location: Phoenix

   Servers: arm01, arm02, arm03, arm04

   Purpose: Information on working with the arm SOC's

Description
===========

We have 4 arm chassis in phx2, each containing 24 SOC's (System On Chip). 

Each chassis has 2 physical network connections going out from it. 
The first one is used for the management interface on each SOC. 
The second one is used for eth0 for each SOC.

Current allocations (2013-04-04): 

arm01 -> secondary arch builders attached to arm.koji.fedoraproject.org
arm02 -> primary arch builders attached to koji.fedoraproject.org
arm03 -> releng and qa and infra instances. 
arm04 -> TBD

Each SOC: 
=========

* Has eth0 and eth1 (unused) and a management interface. 
* has 4 cores
* Has 4GB ram
* Has a 300GB disk

SOC's are addressed by: 

arm{Chassisnumber}-builder{number}.arm.fedoraproject.org

Where Chassisnumber is 01 to 04 
and 
number is 00-23 

PXE installs
============
Kickstarts for the machines are in the kickstarts repo. 

PXE config is on noc01. 

The kickstart installs Fedora 18 and sets them up with a base package set. 
Note that the SOC's can be installed as armv7 or armv5. Secondary arch 
still supports armv5 on older f17/f18 installs, but thats it. 

IPMI tool Management
====================

The SOC's are managed via their mgmt interfaces using a custom ipmitool 
as well as a custom python script called 'cxmanage'. The ipmitool changes 
have been submitted upstream and cxmanage is under review in Fedora. 

The ipmitool is currently installed on noc01 and it has ability to 
talk to them on their management interface. noc01 also serves dhcp and
is a pxeboot server for the SOCs.

Some common commands: 

To set the SOC to boot the next time only with pxe: 
ipmitool -U admin -P thepassword -H arm03-builder11-mgmt.arm.fedoraproject.org chassis bootdev pxe

To set the SOC power off: 
ipmitool -U admin -P thepassword -H arm03-builder11-mgmt.arm.fedoraproject.org power off

To set the SOC power on: 
ipmitool -U admin -P thepassword -H arm03-builder11-mgmt.arm.fedoraproject.org power on

To get a serial over lan console from the SOC: 
ipmitool -U admin -P thepassword -H arm03-builder11-mgmt.arm.fedoraproject.org -I lanplus sol activate

cxmanage
========

The cxmanage tool can be used to update firmware or gather diag info. 

Until cxmanage is packaged, you can use it from a python virtualenv: 

virtualenv --system-site-packages cxmanage
cd cxmanage
source bin/activate
pip install --extra-index-url=http://sources.calxeda.com/python/packages/ cxmanage
<use cxmanage>
deactivate

Some cxmanage commands: 

cxmanage sensor arm03-builder00-mgmt.arm.fedoraproject.org 
Getting sensor readings...
1 successes  |  0 errors  |  0 nodes left  |  .  

MP Temp 0
arm03-builder00-mgmt.arm.fedoraproject.org: 34.00 degrees C
Minimum         : 34.00 degrees C
Maximum         : 34.00 degrees C
Average         : 34.00 degrees C
... (and about 20 more sensors)...

cxmanage info arm03-builder00-mgmt.arm.fedoraproject.org 
Getting info...
1 successes  |  0 errors  |  0 nodes left  |  .  

[ Info from arm03-builder00-mgmt.arm.fedoraproject.org ]
Hardware version   : EnergyCard X04
Firmware version   : ECX-1000-v2.1.5
ECME version       : v0.10.2
CDB version        : v0.10.2
Stage2boot version : v1.1.3
Bootlog version    : v0.10.2
A9boot version     : v2012.10.16-3-g66a3bf3
Uboot version      : v2013.01-rc1_cx_2013.01.17
Ubootenv version   : v2013.01-rc1_cx_2013.01.17
DTB version        : v3.7-4114-g34da2e2

firmware update: 

cxmanage --internal-tftp 10.5.126.41:6969 --all-nodes fwupdate package ECX-1000_update-v2.1.5.tar.gz arm03-builder00-mgmt.arm.fedoraproject.org

(note that this runs against the 00 management interface for the chassis and
updates all the nodes), and that we must run a tftpserver on port 6969 for 
firewall handling. 

Links: 

http://sources.calxeda.com/python/packages/cxmanage/

Contacts: 

help.desk@boston.co.uk is the contact to send repair requests to. 



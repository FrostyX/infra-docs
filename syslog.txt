Log Infrastructure SOP

Logs are centrally referred to our loghost and managed from there by 
rsyslog to create several log outputs.

Epylog provides twice-daily log reports of activities on our systems.
It runs on our central loghost and generates reports on all systems
centrally logging.

Contact Information

   Owner: Fedora Infrastructure Team

   Contact: #fedora-admin, sysadmin-main

   Location: Phoenix

   Servers: log02.phx2.fedoraproject.org

   Purpose: Provides our central logs and reporting


Essential data/locations:

Logs compiled using rsyslog on log02 into a single set of logs for all
systems:

/var/log/merged/


These logs are rotated every day and kept for only 2 days. This set of logs
is only used for immediate analysis and more trivial 'tailing' of 
the log file to watch for events.



Logs for each system separately in: /var/log/hosts 

These logs are maintained forever, practically, or for as long as we
possibly can. They are broken out into a $hostname/$YEAR/$MON/$DAY directory
structure so we can locate a specific day's log immediately.


Log reports generated by epylog:
 Log reports generated by epylog are outputted to /srv/web/epylog/merged

 The reorts are accessible via a web browser from:
    https://admin.fedoraproject.org/epylog/merged/
 However, this path does not generate indexes currently, therefore you must
 receive the log-report notification email which includes a direct link to
 the report.

Configs:
 Epylog configs are controlled by puppet - please see the puppet epylog
 module for more details. Specifically the files in:
   modules/epylog/files/merged/


Generating a one-off epylog report:
 If you wish to generate a specific log report you will need to run the
following command on log02:

sudo /usr/sbin/epylog -c /etc/epylog/merged/epylog.conf --last 5h

You can replace '5h' with other time measurements to control the amount of
time you want to view from the merged logs. This will mail a report
notification to all the people in the sysadmin-logs group.


Future:
- additional log reports for errors from http processes or servers
- SEC - Simple Event Coordinator to report, immediately, on events from a 
        log stream
- New report modules within epylog



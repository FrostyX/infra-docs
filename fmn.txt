fmn (fedmsg notifications) SOP
==============================

  Route individualized notifications to fedora contributors over email, irc.

Contact Information
-------------------

  Owner:        Messaging SIG, Fedora Infrastructure Team
  Contact:      #fedora-apps, #fedora-fedmsg, #fedora-admin, #fedora-noc
  Servers:      notifs-backend01, notifs-web0{1,2}
  Purpose:      Route notifications to users

Description
-----------

  fmn is a pair of systems intended to route fedmsg notifications to Fedora
  contributors and users.

  There is a web interface running on notifs-web01 and notifs-web02 that
  allows users to login and configure their preferences to select this or that
  type of message.  

  There is a backend running on notifs-backend01 where most of the work is
  done.

  The backend process is a 'fedmsg-hub' daemon, controlled by systemd.

  Disable an account (on notifs-backend01):

    $ sudo -u fedmsg /usr/local/bin/fmn-disable-account USERNAME
 
  Restart:

    $ sudo systemctl restart fedmsg-hub

  Watch logs:

    $ sudo journalctl -u fedmsg-hub -f

  Configuration:

    $ ls /etc/fedmsg.d/
    $ sudo fedmsg-config | less

  Monitor performance:
    
    http://threebean.org/fedmsg-health-day.html#FMN

  Upgrade (from lockbox):
  
    $ sudo -i ansible-playbook /srv/web/infra/ansible/playbooks/manual/upgrade/fmn.yml

Mailing Lists
-------------

We use FMN as a way to forward certain kinds of messages to mailing lists so
people can read them the good old fashioned way that they like to.  To
accomplish this, we create 'bot' FAS accounts with their own FMN profiles and
we set their email addresses to the lists in question.

If you need to change the way some set of messages are forwarded, you'll need
to login as those accounts in the web interface (or do surgery on the DB
yourself).  You can find the usernames and passwords of these bot accounts in
the ansible private repo, in the vars file as things like
``fmn_meetingminutes_user`` and ``fmn_meetingminutes_pass``.
